#
# #Import IDs:
# if (location=="Monash") {
# ID <- read.table("S:/R-MNHS-SPP/Bellgrove-data/11.Megan_ONeill/Analysis Scripts_Matlab/IDs.csv", quote="\"")
# } else if (location=="DansLaptop") {
# ID <- read.csv("C:/Users/Dan/Documents/GitHub/10_10_repeatvsnon10_10_repeat/Analyses Scripts_Matlab/IDs.csv", header=F)
# } else setwd(("~"))
# ID<-plyr::rename(ID,c("V1"="ID"))
# data_participant_level$ID<-ID$ID
# rm(ID)
# # drops <- c("ID")
# # data_participant_level<-data_participant_level[,!(names(data_participant_level) %in% drops)]
#
# #import demographic data
# if (location=="Monash") {
# Demographics<-read.csv("S:/R-MNHS-SPP/Bellgrove-data/11.Megan_ONeill/Analysis Scripts_R/10_10_repeat_non10_10_repeat_Demographics_etc.csv", header=T)
# } else if (location=="DansLaptop") {
# Demographics<-read.csv("C:/Users/Dan/Documents/GitHub/10_10_repeatvsnon10_10_repeat/Analyses Scripts_R/10_10_repeat_non10_10_repeat_Demographics_etc.csv", header=T)
# } else setwd(("~"))
#
#
#
# #Merge Demographics into data_participant_level:
# data_participant_level <- merge(data_participant_level, Demographics, by.x = "ID", by.y = "ID")
# rm(Demographics)
#########################################################################################################################
#Rename data columns:
data<-rename(data, c("V1"="ID","V2"="TotalTrialNumber","V3"="Trial","V4"="ITI","V5"="Hemifield", "V6"="Accuracy",
"V7"="Art_neg500_0", "V8"="Art_neg100_100PR","V9"="Art_neg500_100PR", "V10"="Art_neg100_1000",
"V11"="FixBreak_neg500_0", "V12"="FixBreak_neg100_100PR","V13"="FixBreak_neg500_100PR", "V14"="FixBreak_neg100_1000",
"V15"="RT"))
#NOTE: FOR N2c/i,  the _GA or _PA suffix indicates whether N2c/i is measured with a measurement window based
#on Grand average (GA) peak N2c/i latency,  or based on Participant level average (PA) peak N2c/i latency
#Make the required columns into factors:
data$ITI <- factor(data$ITI)
data$Hemifield <- factor(data$Hemifield)
data$Accuracy <- factor(data$Accuracy)
#Rename factor Levels:
data$Hemifield <- revalue(data$Hemifield, c("1"="Left", "2"="Right"))
data$Accuracy <- revalue(data$Accuracy, c("1"="Hit", "0"="RejectedTrial", "2"="WrongButton", "3"="Miss"))
#Re-class required vectors into Logicals:
data$Art_neg500_0<-!as.logical(data$Art_neg500_0)
data$Art_neg100_100PR<-!as.logical(data$Art_neg100_100PR)
data$Art_neg500_100PR<-!as.logical(data$Art_neg500_100PR)
data$Art_neg100_1000<-!as.logical(data$Art_neg100_1000)
data$FixBreak_neg500_0<-!as.logical(data$FixBreak_neg500_0)
data$FixBreak_neg100_100PR<-!as.logical(data$FixBreak_neg100_100PR)
data$FixBreak_neg500_100PR<-!as.logical(data$FixBreak_neg500_100PR)
data$FixBreak_neg100_1000<-!as.logical(data$FixBreak_neg100_1000)
############################################ Import DAT1 Data ##############################################
DAT1 <- read_excel("DAT1genotypes_forR.xlsx")
#Make the required columns into factors:
DAT1$DAT1_3UTR_VNTRraw <- factor(DAT1$DAT1_3UTR_VNTRraw)
DAT1$DAT1_Int8_VNTRraw <- factor(DAT1$DAT1_Int8_VNTRraw)
DAT1$Site <- factor(DAT1$Site)
DAT1$ID<-as.factor(DAT1$ID)
DAT1$DAT1_10_10_repeats  <- revalue(DAT1$DAT1_3UTR_VNTRraw ,
c("10 10"="Two",
"10 11"="One",
"7 10"="One",
"7 9"="Zero",
"8 11"="Zero",
"9 10"="One",
"9 9"="Zero"))
summary(DAT1$DAT1_10_10_repeats)
DAT1$DAT1_3UTR  <- revalue(DAT1$DAT1_3UTR_VNTRraw ,
c("10 10"="10_10_repeat",
"10 11"="non10_10_repeat",
"7 10"="non10_10_repeat",
"7 9"="non10_10_repeat",
"8 11"="non10_10_repeat",
"9 10"="non10_10_repeat",
"9 9"="non10_10_repeat"))
summary(DAT1$DAT1_3UTR)
DAT1$DAT1_int8  <- revalue(DAT1$DAT1_Int8_VNTRraw ,
c("6 6"="6_6_repeat",
"5 6"="non6_6_repeat",
"5 5"="non6_6_repeat"))
summary(DAT1$DAT1_int8)
#Only keep Genotypes for the participants who we actually tested on big dots
#(there are a few extra participant genotypes in the DAT1 sheet)
DAT1 <-DAT1[DAT1$ID %in% data$ID, ]
#How many participant's have missing DAT1 genotype?
summary(DAT1$DAT1_3UTR) #So 4 participant have missing DAT1 genotype
#### Merge the data sets together
data<-merge(data, DAT1, by.x = "ID", by.y = "ID")
View(DAT1)
View(DAT1)
ID_Order <- read_excel("ID_Order_for_Matlab.xlsx")
View(ID_Order)
DAT1<-merge(DAT1, ID_Order, by.x = "ID", by.y = "ID")
DAT1$DAT1_10_10  <- revalue(DAT1$DAT1_3UTR_VNTRraw ,
c("Zero"=0,
"one"=1,
"Two"=2))
DAT1$DAT1_10_10  <- revalue(DAT1$DAT1_10_10_repeats ,
c("Zero"=0,
"one"=1,
"Two"=2))
class(DAT1_10_10_repeats)
class(DAT1$DAT1_10_10_repeats)
DAT1$DAT1_10_10  <- as.numeric(DAT1$DAT1_10_10_repeats)
DAT1$DAT1_10_10  <- revalue(DAT1$DAT1_10_10_repeats ,
c("Zero"="0",
"one"="1",
"Two"="2"))
DAT1$DAT1_10_10_repeats
DAT1$DAT1_10_10  <- revalue(DAT1$DAT1_10_10_repeats ,
c("Zero"="0",
"One"="1",
"Two"="2"))
summary(DAT1$DAT1_10_10)
class(DAT1$DAT1_10_10 )
DAT1$DAT1_10_10  <- as.numeric(DAT1$DAT1_10_10)
class(DAT1$DAT1_10_10 )
? openxlsx::write.xlsx
install.packages("openxlsx")
? dplyr
? dplyr::select
ID_Order_for_Matlab<-dplyr::select(DAT1, ID, DAT1_10_10)
ID_Order_for_Matlab<-dplyr::select(DAT1, ID, DAT1_10_10, Order)
View(ID_Order_for_Matlab)
ID_Order_for_Matlab<-arrange(ID_Order_for_Matlab, Order)
DAT1$DAT1_10_10  <- revalue(DAT1$DAT1_10_10_repeats ,
c("Zero"="0",
"One"="1",
"Two"="2"))
summary(DAT1$DAT1_10_10)
ID_Order_for_Matlab<-dplyr::select(DAT1, ID, DAT1_10_10, Order)
ID_Order_for_Matlab<-arrange(ID_Order_for_Matlab, Order)
? openxlsx::write.xlsx
openxlsx::write.xlsx(ID_Order_for_Matlab, file = "C:/GitHub/big_dots/ID_Order_for_Matlab.xlsx")
installr::install.rtools()
install.rtools()
installr::install.rtools()
install.packages(openxlsx)
install.packages("openxlsx")
install.packages("openxlsx")
openxlsx::write.xlsx(ID_Order_for_Matlab, file = "C:/GitHub/big_dots/ID_Order_for_Matlab.xlsx")
? write.csv
openxlsx::write.xlsx(ID_Order_for_Matlab, file = "ID_Order_for_Matlab.xlsx")
openxlsx::write.xlsx(ID_Order_for_Matlab)
openxlsx::write.xlsx(ID_Order_for_Matlab, file = "C:/GitHub/big_dots/ID_Order_for_Matlab.xlsx")
write.csv(ID_Order_for_Matlab, file = "C:/GitHub/big_dots/ID_Order_for_Matlab", row.names = F)
DAT1genotypes_for_Matlab<-dplyr::select(DAT1, ID, DAT1_10_10, Order)
View(DAT1genotypes_for_Matlab)
DAT1genotypes_for_Matlab<-arrange(DAT1genotypes_for_Matlab, Order)
DAT1genotypes_for_Matlab<-dplyr::arrange(DAT1genotypes_for_Matlab, Order)
write.xlsx(DAT1genotypes_for_Matlab, file = "C:/GitHub/big_dots/DAT1genotypes_for_Matlab.xlsx")
? write.xlsx2
install.packages("xlsx ")
install.packages("xlsx")
? write.xlsx2
library(xlsx)
? write.xlsx2
? write.xlsx2
xlsx::write.xlsx2(DAT1genotypes_for_Matlab, file = "C:/GitHub/big_dots/DAT1genotypes_for_Matlab.xlsx", row.names = F)
####Which computer/directory is this being run on?
location<-"Monash"
# location<-"DansLaptop"
if (location=="Monash") {
setwd(("C:/GitHub/big_dots/Analyses Scripts_R"))
} else if (location=="DansLaptop") {
setwd(("C:/Users/Dan/Documents/GitHub/big_dots/Analyses Scripts_R"))
} else setwd(("~"))
####################################
#######  How to use ################
####################################
# 1) Install the packages and software specified below. (consider also updating all installed packages by chosing Update on the Packages tab)
# 2) Set the working directory (setwd) above, and directory where you have "data_ParticipantLevel", "master_matrix_R" and "ID_vector" saved
# 3) Hit Knit Word (or Knit HTML)! (Output can take while due to bootstrapping the robust effect size and calculating the Bayesian Highest Density Iinterval)
####################################
######  FIRST TIME ONLY ############
####################################
#Remove # in front of the line below and run the code. Replace the # after installing the packages, otherwise the R markdown script will give errors.
# install.packages(c("MASS", "akima", "robustbase", "cobs", "robust", "mgcv", "scatterplot3d", "quantreg", "rrcov", "lars", "pwr", "trimcluster", "mc2d", "psych", "Rfit","MBESS", "BayesFactor", "PoweR", "ggplot2", "reshape2", "plyr", "devtools", "rmarkdown","gmodels", "HLMdiag", "car", "gridExtra", "bootES", "BEST","foreign","nlme","pastecs","multcomp","ggplot2","compute.es","ez","lattice","lme4","effects","diagram","png", "grid", "dplyr","readxl", "openxlsx"))
###################################################################################################################################
## Install relevant libraries
library(foreign)
library(car)
library(nlme)
library(ggplot2)
library(pastecs)
library(psych)
library(plyr)
library(multcomp)
library(reshape2)
library(compute.es)
library(ez)
library(lattice)
library(lme4)
library(png)
library(grid)
library(readxl)
###### Import single trial data:
if (location=="Monash") {
data <- read.csv("C:/GitHub/big_dots/master_matrix_R_BigDots.csv", header=FALSE)
} else if (location=="DansLaptop") {
data <- read.csv("C:/Users/Dan/Documents/GitHub/big_dots/master_matrix_R_BigDots.csv", header=FALSE)
} else setwd(("~"))
#Import IDs:
if (location=="Monash") {
ID <- read.table("C:/GitHub/big_dots/ID_vector_BigDots.csv", quote="\"")
} else if (location=="DansLaptop") {
ID <- read.table("C:/Users/Dan/Documents/GitHub/big_dots/ID_vector_BigDots.csv", quote="\"")
} else setwd(("~"))
data$ID<-data[,1]
#Replace the participant numbers with IDs:
data[,1]<-ID[,1]
#Remove the seperate ID vector now it has been included into data dataframe
rm(ID)
drops <- c("ID")
data<-data[,!(names(data) %in% drops)]
#########################################################################################################################
#data_ParticipantLevel:
# ###### Import data_ParticipantLevel:
# if (location=="Monash") {
# data_participant_level <- read.csv("C:/GitHub/big_dots/participant_level_matrix.csv", header=FALSE)
# } else if (location=="DansLaptop") {
# data_participant_level <- read.csv("C:/Users/Dan/Documents/GitHub/big_dots/participant_level_matrix.csv", header=FALSE)
# } else setwd(("~"))
#
#
# #Import IDs:
# if (location=="Monash") {
# ID <- read.table("S:/R-MNHS-SPP/Bellgrove-data/11.Megan_ONeill/Analysis Scripts_Matlab/IDs.csv", quote="\"")
# } else if (location=="DansLaptop") {
# ID <- read.csv("C:/Users/Dan/Documents/GitHub/10_10_repeatvsnon10_10_repeat/Analyses Scripts_Matlab/IDs.csv", header=F)
# } else setwd(("~"))
# ID<-plyr::rename(ID,c("V1"="ID"))
# data_participant_level$ID<-ID$ID
# rm(ID)
# # drops <- c("ID")
# # data_participant_level<-data_participant_level[,!(names(data_participant_level) %in% drops)]
#
# #import demographic data
# if (location=="Monash") {
# Demographics<-read.csv("S:/R-MNHS-SPP/Bellgrove-data/11.Megan_ONeill/Analysis Scripts_R/10_10_repeat_non10_10_repeat_Demographics_etc.csv", header=T)
# } else if (location=="DansLaptop") {
# Demographics<-read.csv("C:/Users/Dan/Documents/GitHub/10_10_repeatvsnon10_10_repeat/Analyses Scripts_R/10_10_repeat_non10_10_repeat_Demographics_etc.csv", header=T)
# } else setwd(("~"))
#
#
#
# #Merge Demographics into data_participant_level:
# data_participant_level <- merge(data_participant_level, Demographics, by.x = "ID", by.y = "ID")
# rm(Demographics)
#########################################################################################################################
#Rename data columns:
data<-rename(data, c("V1"="ID","V2"="TotalTrialNumber","V3"="Trial","V4"="ITI","V5"="Hemifield", "V6"="Accuracy",
"V7"="Art_neg500_0", "V8"="Art_neg100_100PR","V9"="Art_neg500_100PR", "V10"="Art_neg100_1000",
"V11"="FixBreak_neg500_0", "V12"="FixBreak_neg100_100PR","V13"="FixBreak_neg500_100PR", "V14"="FixBreak_neg100_1000",
"V15"="RT"))
#NOTE: FOR N2c/i,  the _GA or _PA suffix indicates whether N2c/i is measured with a measurement window based
#on Grand average (GA) peak N2c/i latency,  or based on Participant level average (PA) peak N2c/i latency
#Make the required columns into factors:
data$ITI <- factor(data$ITI)
data$Hemifield <- factor(data$Hemifield)
data$Accuracy <- factor(data$Accuracy)
#Rename factor Levels:
data$Hemifield <- revalue(data$Hemifield, c("1"="Left", "2"="Right"))
data$Accuracy <- revalue(data$Accuracy, c("1"="Hit", "0"="RejectedTrial", "2"="WrongButton", "3"="Miss"))
#Re-class required vectors into Logicals:
data$Art_neg500_0<-!as.logical(data$Art_neg500_0)
data$Art_neg100_100PR<-!as.logical(data$Art_neg100_100PR)
data$Art_neg500_100PR<-!as.logical(data$Art_neg500_100PR)
data$Art_neg100_1000<-!as.logical(data$Art_neg100_1000)
data$FixBreak_neg500_0<-!as.logical(data$FixBreak_neg500_0)
data$FixBreak_neg100_100PR<-!as.logical(data$FixBreak_neg100_100PR)
data$FixBreak_neg500_100PR<-!as.logical(data$FixBreak_neg500_100PR)
data$FixBreak_neg100_1000<-!as.logical(data$FixBreak_neg100_1000)
############################################ Import DAT1 Data ##############################################
DAT1 <- read_excel("DAT1genotypes_forR.xlsx")
#Make the required columns into factors:
DAT1$DAT1_3UTR_VNTRraw <- factor(DAT1$DAT1_3UTR_VNTRraw)
DAT1$DAT1_Int8_VNTRraw <- factor(DAT1$DAT1_Int8_VNTRraw)
DAT1$Site <- factor(DAT1$Site)
DAT1$ID<-as.factor(DAT1$ID)
DAT1$DAT1_10_10_repeats  <- revalue(DAT1$DAT1_3UTR_VNTRraw ,
c("10 10"="Two",
"10 11"="One",
"7 10"="One",
"7 9"="Zero",
"8 11"="Zero",
"9 10"="One",
"9 9"="Zero"))
summary(DAT1$DAT1_10_10_repeats)
DAT1$DAT1_3UTR  <- revalue(DAT1$DAT1_3UTR_VNTRraw ,
c("10 10"="10_10_repeat",
"10 11"="non10_10_repeat",
"7 10"="non10_10_repeat",
"7 9"="non10_10_repeat",
"8 11"="non10_10_repeat",
"9 10"="non10_10_repeat",
"9 9"="non10_10_repeat"))
summary(DAT1$DAT1_3UTR)
DAT1$DAT1_int8  <- revalue(DAT1$DAT1_Int8_VNTRraw ,
c("6 6"="6_6_repeat",
"5 6"="non6_6_repeat",
"5 5"="non6_6_repeat"))
summary(DAT1$DAT1_int8)
#Only keep Genotypes for the participants who we actually tested on big dots
#(there are a few extra participant genotypes in the DAT1 sheet)
DAT1 <-DAT1[DAT1$ID %in% data$ID, ]
#How many participant's have missing DAT1 genotype?
summary(DAT1$DAT1_3UTR) #So 4 participant have missing DAT1 genotype
#### Merge the data sets together
data<-merge(data, DAT1, by.x = "ID", by.y = "ID")
################################################################################################
ID_Order <- read_excel("ID_Order_for_Matlab.xlsx")
DAT1<-merge(DAT1, ID_Order, by.x = "ID", by.y = "ID")
DAT1$DAT1_10_10  <- revalue(DAT1$DAT1_10_10_repeats ,
c("Zero"="0",
"One"="1",
"Two"="2"))
summary(DAT1$DAT1_10_10)
DAT1<-dplyr::arrange(DAT1, Order)
View(DAT1)
DAT1genotypes_for_Matlab<-dplyr::select(DAT1, ID, DAT1_10_10, Order)
DAT1genotypes_for_Matlab<-dplyr::select(DAT1, ID, DAT1_10_10)
View(ID_Order_for_Matlab)
DAT1genotypes_for_Matlab<-dplyr::select(DAT1, ID, DAT1_10_10)
View(DAT1genotypes_for_Matlab)
ID_Order <- read_excel("ID_Order_for_Matlab.xlsx")
DAT1<-merge(DAT1, ID_Order, by.x = "ID", by.y = "ID")
DAT1$DAT1_10_10  <- revalue(DAT1$DAT1_10_10_repeats ,
c("Zero"="0",
"One"="1",
"Two"="2"))
DAT1<-dplyr::arrange(DAT1, Order)
DAT1genotypes_for_Matlab<-dplyr::select(DAT1, ID, DAT1_10_10)
xlsx::write.xlsx2(DAT1genotypes_for_Matlab, file = "C:/GitHub/big_dots/DAT1genotypes_for_Matlab.xlsx", row.names = F)
ID_Order <- read_excel("ID_Order_for_Matlab.xlsx")
DAT1<-merge(DAT1, ID_Order, by.x = "ID", by.y = "ID")
DAT1$DAT1_10_10  <- revalue(DAT1$DAT1_10_10_repeats ,
c("Zero"="0",
"One"="1",
"Two"="2"))
DAT1<-dplyr::arrange(DAT1, Order)
DAT1genotypes_for_Matlab<-dplyr::select(DAT1, ID, DAT1_10_10)
xlsx::write.xlsx2(DAT1genotypes_for_Matlab, file = "C:/GitHub/big_dots/DAT1genotypes_for_Matlab.xlsx", row.names = F)
ID_Order <- read_excel("ID_Order_for_Matlab.xlsx")
DAT1<-merge(DAT1, ID_Order, by.x = "ID", by.y = "ID")
DAT1$DAT1_10_10  <- revalue(DAT1$DAT1_10_10_repeats ,
c("Zero"="0",
"One"="1",
"Two"="2"))
DAT1<-dplyr::arrange(DAT1, Order)
DAT1genotypes_for_Matlab<-dplyr::select(DAT1, ID, DAT1_10_10)
xlsx::write.xlsx2(DAT1genotypes_for_Matlab, file = "C:/GitHub/big_dots/DAT1genotypes_for_Matlab.xlsx", row.names = F)
####Which computer/directory is this being run on?
location<-"Monash"
# location<-"DansLaptop"
if (location=="Monash") {
setwd(("C:/GitHub/big_dots/Analyses Scripts_R"))
} else if (location=="DansLaptop") {
setwd(("C:/Users/Dan/Documents/GitHub/big_dots/Analyses Scripts_R"))
} else setwd(("~"))
####################################
#######  How to use ################
####################################
# 1) Install the packages and software specified below. (consider also updating all installed packages by chosing Update on the Packages tab)
# 2) Set the working directory (setwd) above, and directory where you have "data_ParticipantLevel", "master_matrix_R" and "ID_vector" saved
# 3) Hit Knit Word (or Knit HTML)! (Output can take while due to bootstrapping the robust effect size and calculating the Bayesian Highest Density Iinterval)
####################################
######  FIRST TIME ONLY ############
####################################
#Remove # in front of the line below and run the code. Replace the # after installing the packages, otherwise the R markdown script will give errors.
# install.packages(c("MASS", "akima", "robustbase", "cobs", "robust", "mgcv", "scatterplot3d", "quantreg", "rrcov", "lars", "pwr", "trimcluster", "mc2d", "psych", "Rfit","MBESS", "BayesFactor", "PoweR", "ggplot2", "reshape2", "plyr", "devtools", "rmarkdown","gmodels", "HLMdiag", "car", "gridExtra", "bootES", "BEST","foreign","nlme","pastecs","multcomp","ggplot2","compute.es","ez","lattice","lme4","effects","diagram","png", "grid", "dplyr","readxl", "openxlsx"))
###################################################################################################################################
## Install relevant libraries
library(foreign)
library(car)
library(nlme)
library(ggplot2)
library(pastecs)
library(psych)
library(plyr)
library(multcomp)
library(reshape2)
library(compute.es)
library(ez)
library(lattice)
library(lme4)
library(png)
library(grid)
library(readxl)
###### Import single trial data:
if (location=="Monash") {
data <- read.csv("C:/GitHub/big_dots/master_matrix_R_BigDots.csv", header=FALSE)
} else if (location=="DansLaptop") {
data <- read.csv("C:/Users/Dan/Documents/GitHub/big_dots/master_matrix_R_BigDots.csv", header=FALSE)
} else setwd(("~"))
#Import IDs:
if (location=="Monash") {
ID <- read.table("C:/GitHub/big_dots/ID_vector_BigDots.csv", quote="\"")
} else if (location=="DansLaptop") {
ID <- read.table("C:/Users/Dan/Documents/GitHub/big_dots/ID_vector_BigDots.csv", quote="\"")
} else setwd(("~"))
data$ID<-data[,1]
#Replace the participant numbers with IDs:
data[,1]<-ID[,1]
#Remove the seperate ID vector now it has been included into data dataframe
rm(ID)
drops <- c("ID")
data<-data[,!(names(data) %in% drops)]
#########################################################################################################################
#data_ParticipantLevel:
# ###### Import data_ParticipantLevel:
# if (location=="Monash") {
# data_participant_level <- read.csv("C:/GitHub/big_dots/participant_level_matrix.csv", header=FALSE)
# } else if (location=="DansLaptop") {
# data_participant_level <- read.csv("C:/Users/Dan/Documents/GitHub/big_dots/participant_level_matrix.csv", header=FALSE)
# } else setwd(("~"))
#
#
# #Import IDs:
# if (location=="Monash") {
# ID <- read.table("S:/R-MNHS-SPP/Bellgrove-data/11.Megan_ONeill/Analysis Scripts_Matlab/IDs.csv", quote="\"")
# } else if (location=="DansLaptop") {
# ID <- read.csv("C:/Users/Dan/Documents/GitHub/10_10_repeatvsnon10_10_repeat/Analyses Scripts_Matlab/IDs.csv", header=F)
# } else setwd(("~"))
# ID<-plyr::rename(ID,c("V1"="ID"))
# data_participant_level$ID<-ID$ID
# rm(ID)
# # drops <- c("ID")
# # data_participant_level<-data_participant_level[,!(names(data_participant_level) %in% drops)]
#
# #import demographic data
# if (location=="Monash") {
# Demographics<-read.csv("S:/R-MNHS-SPP/Bellgrove-data/11.Megan_ONeill/Analysis Scripts_R/10_10_repeat_non10_10_repeat_Demographics_etc.csv", header=T)
# } else if (location=="DansLaptop") {
# Demographics<-read.csv("C:/Users/Dan/Documents/GitHub/10_10_repeatvsnon10_10_repeat/Analyses Scripts_R/10_10_repeat_non10_10_repeat_Demographics_etc.csv", header=T)
# } else setwd(("~"))
#
#
#
# #Merge Demographics into data_participant_level:
# data_participant_level <- merge(data_participant_level, Demographics, by.x = "ID", by.y = "ID")
# rm(Demographics)
#########################################################################################################################
#Rename data columns:
data<-rename(data, c("V1"="ID","V2"="TotalTrialNumber","V3"="Trial","V4"="ITI","V5"="Hemifield", "V6"="Accuracy",
"V7"="Art_neg500_0", "V8"="Art_neg100_100PR","V9"="Art_neg500_100PR", "V10"="Art_neg100_1000",
"V11"="FixBreak_neg500_0", "V12"="FixBreak_neg100_100PR","V13"="FixBreak_neg500_100PR", "V14"="FixBreak_neg100_1000",
"V15"="RT"))
#NOTE: FOR N2c/i,  the _GA or _PA suffix indicates whether N2c/i is measured with a measurement window based
#on Grand average (GA) peak N2c/i latency,  or based on Participant level average (PA) peak N2c/i latency
#Make the required columns into factors:
data$ITI <- factor(data$ITI)
data$Hemifield <- factor(data$Hemifield)
data$Accuracy <- factor(data$Accuracy)
#Rename factor Levels:
data$Hemifield <- revalue(data$Hemifield, c("1"="Left", "2"="Right"))
data$Accuracy <- revalue(data$Accuracy, c("1"="Hit", "0"="RejectedTrial", "2"="WrongButton", "3"="Miss"))
#Re-class required vectors into Logicals:
data$Art_neg500_0<-!as.logical(data$Art_neg500_0)
data$Art_neg100_100PR<-!as.logical(data$Art_neg100_100PR)
data$Art_neg500_100PR<-!as.logical(data$Art_neg500_100PR)
data$Art_neg100_1000<-!as.logical(data$Art_neg100_1000)
data$FixBreak_neg500_0<-!as.logical(data$FixBreak_neg500_0)
data$FixBreak_neg100_100PR<-!as.logical(data$FixBreak_neg100_100PR)
data$FixBreak_neg500_100PR<-!as.logical(data$FixBreak_neg500_100PR)
data$FixBreak_neg100_1000<-!as.logical(data$FixBreak_neg100_1000)
############################################ Import DAT1 Data ##############################################
DAT1 <- read_excel("DAT1genotypes_forR.xlsx")
#Make the required columns into factors:
DAT1$DAT1_3UTR_VNTRraw <- factor(DAT1$DAT1_3UTR_VNTRraw)
DAT1$DAT1_Int8_VNTRraw <- factor(DAT1$DAT1_Int8_VNTRraw)
DAT1$Site <- factor(DAT1$Site)
DAT1$ID<-as.factor(DAT1$ID)
DAT1$DAT1_10_10_repeats  <- revalue(DAT1$DAT1_3UTR_VNTRraw ,
c("10 10"="Two",
"10 11"="One",
"7 10"="One",
"7 9"="Zero",
"8 11"="Zero",
"9 10"="One",
"9 9"="Zero"))
summary(DAT1$DAT1_10_10_repeats)
DAT1$DAT1_3UTR  <- revalue(DAT1$DAT1_3UTR_VNTRraw ,
c("10 10"="10_10_repeat",
"10 11"="non10_10_repeat",
"7 10"="non10_10_repeat",
"7 9"="non10_10_repeat",
"8 11"="non10_10_repeat",
"9 10"="non10_10_repeat",
"9 9"="non10_10_repeat"))
summary(DAT1$DAT1_3UTR)
DAT1$DAT1_int8  <- revalue(DAT1$DAT1_Int8_VNTRraw ,
c("6 6"="6_6_repeat",
"5 6"="non6_6_repeat",
"5 5"="non6_6_repeat"))
summary(DAT1$DAT1_int8)
#Only keep Genotypes for the participants who we actually tested on big dots
#(there are a few extra participant genotypes in the DAT1 sheet)
DAT1 <-DAT1[DAT1$ID %in% data$ID, ]
#How many participant's have missing DAT1 genotype?
summary(DAT1$DAT1_3UTR) #So 4 participant have missing DAT1 genotype
#### Merge the data sets together
data<-merge(data, DAT1, by.x = "ID", by.y = "ID")
################################################################################################
##Creat ordered DAT1 genotype .xlsx file for matlab
ID_Order <- read_excel("ID_Order_for_Matlab.xlsx")
DAT1<-merge(DAT1, ID_Order, by.x = "ID", by.y = "ID")
DAT1$DAT1_10_10  <- revalue(DAT1$DAT1_10_10_repeats ,
c("Zero"="0",
"One"="1",
"Two"="2"))
DAT1<-dplyr::arrange(DAT1, Order)
DAT1genotypes_for_Matlab<-dplyr::select(DAT1, ID, DAT1_10_10)
xlsx::write.xlsx2(DAT1genotypes_for_Matlab, file = "C:/GitHub/big_dots/DAT1genotypes_for_Matlab.xlsx", row.names = F)
